Option Explicit

Public Sub ExportarSetor(ByVal setor As String)
    Dim ws As Worksheet, wdApp As Object, wdDoc As Object, wdRng As Object
    
    Debug.Print ">>> Iniciando setor: " & setor
    
    InitConfig
    Set ws = ThisWorkbook.Sheets(NOME_SHEET_GRAFICOS)
    
    Debug.Print " - Filtrando slicer..."
    FiltrarSlicerPorSetor setor
    
    Debug.Print " - Atualizando títulos..."
    AtualizarTituloGraficos setor
    
    Debug.Print " - Abrindo Word..."
    Set wdApp = AbrirWord
    Set wdDoc = wdApp.Documents.Open(CAMINHO_DOC)
    
    Debug.Print " - Localizando título no Word..."
    Set wdRng = LocalizarTituloNoWord(wdDoc, setor)
    If wdRng Is Nothing Then
        Debug.Print "   !! Não encontrou título: " & setor
        Exit Sub
    End If
    
    Debug.Print " - Copiando gráficos..."
    CopiarGraficosParaWord ws, wdDoc, wdRng, FONTE
    
    Debug.Print ">>> Finalizado setor: " & setor
End Sub

Public Sub ExportarTodosSetores(setores)
    Dim i As Long
    
    ' Loop em cada setor
    For i = LBound(setores) To UBound(setores)
        On Error Resume Next
        ExportarSetor setores(i)
        If Err.Number <> 0 Then
            Debug.Print "Erro ao exportar UORG: " & setores(i) & " | " & Err.Description
            Err.Clear
        End If
        On Error GoTo 0
    Next i
    
    MsgBox "Exportação concluída para todos os setores!", vbInformation
End Sub
